# Story 5.3: Manual Testing Checklist

## Overview

This document provides manual testing scenarios for Story 5.3: View As Role Preview Mode. These tests verify that the preview mode functionality matches exactly what external party users see when logged in with their respective roles.

**Critical Requirement:** Preview mode must show EXACTLY what the role sees when logged in directly. Any discrepancy is a bug.

---

## Test Environment Setup

1. Ensure you have test accounts for all roles:
   - HR Admin: `hradmin@test.com`
   - Sodexo: `sodexo@test.com`
   - √ñMC: `omc@test.com`
   - Payroll: `payroll@test.com`
   - Toplux: `toplux@test.com`

2. Ensure the database has column configurations with varying permissions per role
3. Ensure there are test employees in the system
4. Use two different browsers or browser profiles for side-by-side comparison

---

## Scenario 1: Sodexo Preview Match

**Objective:** Verify that previewing as Sodexo shows exactly what a Sodexo user sees.

### Steps:

1. **Login as HR Admin** in Browser 1
   - Navigate to `/dashboard`
   - Verify you see all columns (HR Admin has full access)

2. **Select Sodexo from "View As" dropdown**
   - Locate the "View As:" dropdown in the dashboard header
   - Select "Sodexo" from the list
   - Verify yellow banner appears with text: "üëÅÔ∏è Viewing as Sodexo - Preview Mode"
   - Verify banner has "Exit Preview" button

3. **Note visible columns in preview mode**
   - Document which columns are visible
   - Note which columns appear read-only (have lock icon)
   - Check if any Sodexo custom columns appear

4. **Login as actual Sodexo user** in Browser 2
   - Navigate to `/dashboard`
   - Document which columns are visible
   - Note which columns appear read-only

5. **Compare the two views**
   - ‚úÖ **PASS:** Column visibility matches exactly between preview and actual login
   - ‚úÖ **PASS:** Read-only indicators match between preview and actual login
   - ‚úÖ **PASS:** Custom columns for Sodexo appear in both views
   - ‚ùå **FAIL:** Any column appears in one view but not the other
   - ‚ùå **FAIL:** Edit permissions differ between the two views

### Expected Results:

- Preview mode shows EXACTLY what Sodexo user sees
- No extra columns visible in preview that Sodexo doesn't have access to
- No missing columns that Sodexo should see
- Edit indicators match (all should be disabled in preview mode for HR Admin)

---

## Scenario 2: √ñMC Preview Match

**Objective:** Verify that previewing as √ñMC shows exactly what an √ñMC user sees.

### Steps:

1. **In Browser 1 (HR Admin), switch to √ñMC preview**
   - If still in Sodexo preview, select "√ñMC" from dropdown
   - Verify banner updates to "Viewing as OMC - Preview Mode"
   - Note the instant column update (no page reload)

2. **Document √ñMC visible columns**
   - List all visible columns
   - Note any √ñMC-specific custom columns
   - Verify Sodexo custom columns are NOT visible

3. **Login as actual √ñMC user** in Browser 2
   - Navigate to `/dashboard`
   - Document which columns are visible

4. **Compare the two views**
   - ‚úÖ **PASS:** Column visibility matches exactly
   - ‚úÖ **PASS:** √ñMC custom columns visible in both
   - ‚úÖ **PASS:** Sodexo custom columns NOT visible in either
   - ‚ùå **FAIL:** Any discrepancy in visible columns

### Expected Results:

- Preview accurately reflects √ñMC permissions
- Role-specific custom columns display correctly
- Other roles' custom columns are hidden

---

## Scenario 3: Edit Actions Disabled in Preview Mode

**Objective:** Verify that all edit actions are disabled when in preview mode.

### Steps:

1. **As HR Admin, enter preview mode** (any role)
   - Select any external party role from dropdown

2. **Test "Add Employee" button**
   - Locate "Add Employee" button in header
   - ‚úÖ **PASS:** Button is disabled (grayed out)
   - ‚úÖ **PASS:** Hovering shows tooltip: "Editing disabled in preview mode"
   - Try clicking the button
   - ‚úÖ **PASS:** Click does nothing (modal doesn't open)

3. **Test "Import Employees" button**
   - Locate "Import Employees" button
   - ‚úÖ **PASS:** Button is disabled
   - ‚úÖ **PASS:** Click does nothing

4. **Test inline cell editing**
   - Try clicking on an editable cell (e.g., First Name)
   - ‚úÖ **PASS:** Cell does NOT become editable
   - ‚úÖ **PASS:** No edit cursor appears
   - ‚ùå **FAIL:** Cell becomes editable in preview mode (this is a bug)

5. **Exit preview mode**
   - Click "Exit Preview" button
   - ‚úÖ **PASS:** Banner disappears
   - ‚úÖ **PASS:** "Add Employee" button becomes enabled
   - ‚úÖ **PASS:** Cells become editable again

### Expected Results:

- All edit actions completely disabled in preview mode
- No data modification possible while previewing
- Edit capabilities restore immediately after exiting preview

---

## Scenario 4: Search and Sort in Preview Mode

**Objective:** Verify search and sort functionality works correctly in preview mode.

### Steps:

1. **Enter Payroll preview mode**
   - Select "Payroll" from View As dropdown

2. **Test global search**
   - Type a name into the search box (e.g., "John")
   - ‚úÖ **PASS:** Table filters to show matching employees
   - ‚úÖ **PASS:** Only Payroll-visible columns are shown in results
   - Clear the search
   - ‚úÖ **PASS:** Full table returns

3. **Test column sorting**
   - Click "First Name" column header to sort
   - ‚úÖ **PASS:** Table sorts by first name (A-Z)
   - Click again
   - ‚úÖ **PASS:** Table sorts in reverse (Z-A)
   - Try sorting by another column
   - ‚úÖ **PASS:** Sort works correctly

4. **Test filters (if applicable)**
   - Use "Include Archived" checkbox
   - ‚úÖ **PASS:** Archived employees appear in table
   - Use "Include Terminated" checkbox
   - ‚úÖ **PASS:** Terminated employees appear

5. **Verify search respects column visibility**
   - Search for content in a column that Payroll CANNOT see
   - ‚úÖ **PASS:** No results appear (can't search hidden columns)
   - Search for content in a column Payroll CAN see
   - ‚úÖ **PASS:** Results appear correctly

### Expected Results:

- Search and sort work normally in preview mode
- Search respects role's column visibility (can't find data in hidden columns)
- Filtering checkboxes function correctly

---

## Scenario 5: Exit Preview Restoration

**Objective:** Verify that exiting preview mode fully restores HR Admin view.

### Steps:

1. **As HR Admin, enter Toplux preview**
   - Select "Toplux" from dropdown
   - Note the limited columns visible

2. **Document Toplux-visible columns**
   - Count the number of columns visible
   - Note any hidden masterdata columns

3. **Exit preview mode**
   - Click "Exit Preview" button in banner
   - Verify banner disappears immediately

4. **Verify HR Admin view restored**
   - ‚úÖ **PASS:** ALL columns are now visible (HR Admin sees everything)
   - ‚úÖ **PASS:** "Add Employee" button is enabled
   - ‚úÖ **PASS:** "Import Employees" button is enabled
   - ‚úÖ **PASS:** Cells are editable again
   - ‚úÖ **PASS:** Dropdown shows "HR Admin (Default)" selected

5. **Test edit capability**
   - Click on a cell and edit a value
   - ‚úÖ **PASS:** Cell becomes editable
   - ‚úÖ **PASS:** Changes can be saved
   - Revert the change (or use test data)

### Expected Results:

- Full HR Admin privileges restored immediately
- All columns visible again
- Full edit capabilities return
- No lingering preview mode state

---

## Scenario 6: Custom Columns Per Role

**Objective:** Verify custom columns display correctly based on role in preview mode.

### Prerequisite Setup:

1. **Create a custom column for Sodexo** (if not exists)
   - Login as Sodexo user
   - Create a custom column (e.g., "Sodexo Badge Number")
   - Add data to a few employees

2. **Create a custom column for √ñMC** (if not exists)
   - Login as √ñMC user
   - Create a custom column (e.g., "√ñMC Department Code")
   - Add data to a few employees

### Steps:

1. **As HR Admin, preview as Sodexo**
   - Select "Sodexo" from View As dropdown
   - ‚úÖ **PASS:** Sodexo custom column "Sodexo Badge Number" is visible
   - ‚úÖ **PASS:** √ñMC custom column "√ñMC Department Code" is NOT visible
   - Verify column data displays correctly

2. **Switch to √ñMC preview**
   - Select "√ñMC" from View As dropdown
   - ‚úÖ **PASS:** √ñMC custom column "√ñMC Department Code" is visible
   - ‚úÖ **PASS:** Sodexo custom column "Sodexo Badge Number" is NOT visible
   - Verify column data displays correctly

3. **Switch to Payroll preview**
   - Select "Payroll" from View As dropdown
   - ‚úÖ **PASS:** Neither Sodexo nor √ñMC custom columns are visible
   - ‚úÖ **PASS:** Only Payroll's own custom columns (if any) are visible

4. **Exit preview and check HR Admin view**
   - Click "Exit Preview"
   - ‚úÖ **PASS:** ALL custom columns from ALL roles are visible (HR Admin sees everything)

### Expected Results:

- Custom columns are role-specific in preview mode
- HR Admin sees all custom columns from all roles
- Preview accurately reflects role's custom column access

---

## Test Results Summary

### Test Execution Date: ********\_********

| Scenario                    | Status            | Notes |
| --------------------------- | ----------------- | ----- |
| 1. Sodexo Preview Match     | ‚¨ú PASS / ‚¨ú FAIL |       |
| 2. √ñMC Preview Match        | ‚¨ú PASS / ‚¨ú FAIL |       |
| 3. Edit Actions Disabled    | ‚¨ú PASS / ‚¨ú FAIL |       |
| 4. Search and Sort          | ‚¨ú PASS / ‚¨ú FAIL |       |
| 5. Exit Preview Restoration | ‚¨ú PASS / ‚¨ú FAIL |       |
| 6. Custom Columns Per Role  | ‚¨ú PASS / ‚¨ú FAIL |       |

### Overall Result: ‚¨ú PASS / ‚¨ú FAIL

**Tester Name:** ********\_********  
**Tester Role:** ********\_********  
**Test Environment:** ********\_********

---

## Known Issues / Bugs Found

_Document any bugs discovered during manual testing:_

1.
2.
3.

---

## Acceptance Criteria Coverage

This manual testing checklist covers the following acceptance criteria:

- **AC 1:** Role selector dropdown renders and displays all roles ‚úì
- **AC 2:** Selecting role switches table view to display only permitted columns ‚úì
- **AC 3:** Visual banner displays with role name and Exit Preview button ‚úì
- **AC 4:** Column visibility and read-only states match actual role login ‚úì
- **AC 5:** Edit actions disabled in preview mode ‚úì
- **AC 6:** Switching between roles updates view instantly ‚úì
- **AC 7:** Exit Preview restores HR Admin view ‚úì
- **AC 8:** Preview mode is client-side only ‚úì
- **AC 9:** Search and sort work in preview mode ‚úì
- **AC 10:** Manual testing verifies preview matches actual login for 2+ roles ‚úì

---

**End of Manual Testing Checklist**
