# Story 5.10: Add Mouseover Tooltips to Action Buttons

## Status

Draft

## Story

**As a** user,  
**I want** to see descriptive tooltips when hovering over action buttons,  
**so that** I understand what each button does before clicking.

## Acceptance Criteria

1. Add tooltips (using shadcn/ui Tooltip component) to:
   - Column settings action buttons (Edit, Delete, Hide, View permissions)
   - Employee table row actions (Edit, Archive, Terminate)
   - Add Employee button
   - Import CSV button
   - Add Custom Column button
   - Important Dates actions
2. Tooltip text should be concise and descriptive (e.g., "Edit employee details", "Archive employee (soft delete)")
3. Tooltips appear on hover after ~500ms delay
4. Tooltips are accessible (keyboard focus triggers tooltip)
5. Tooltips work on all major browsers

## Tasks / Subtasks

- [ ] Update Employee Table Actions (AC: 1, 2, 3, 4, 5)
  - [ ] Wrap Archive/Unarchive button in Tooltip component with text "Archive employee" / "Restore employee"
  - [ ] Wrap Terminate/Reactivate button in Tooltip component with text "Mark as terminated" / "Reactivate employee"
  - [ ] Update `src/components/dashboard/employee-table.tsx` around lines 418-454

- [ ] Update Dashboard Header Buttons (AC: 1, 2, 3, 4, 5)
  - [ ] Add tooltip to "Add Employee" button with text "Add new employee to the system"
  - [ ] Add tooltip to "Import CSV" button with text "Import employees from CSV file"
  - [ ] Add tooltip to "Add Custom Column" button with text "Create a new custom column"
  - [ ] Update `src/app/[locale]/dashboard/page.tsx` around lines 95-123

- [ ] Update Important Dates Table Actions (AC: 1, 2, 3, 4, 5)
  - [ ] Wrap Delete button in Tooltip component with text "Delete this important date"
  - [ ] Update `src/components/dashboard/important-dates-table.tsx` around line 228

- [ ] Update Column Settings Admin Page Actions (AC: 1, 2, 3, 4, 5)
  - [ ] Add tooltips to Delete and Hide/Show column buttons in Column Settings Table
  - [ ] Tooltip text: "Delete custom column" for delete, "Hide column from table" / "Show column in table" for visibility toggle
  - [ ] Update `src/components/admin/column-settings-table.tsx` if tooltips not already present

- [ ] Update Manage Columns Dialog (AC: 1, 2, 3, 4, 5)
  - [ ] Add tooltip to Edit button in Manage Columns dropdown with text "Edit column name and category"
  - [ ] Update `src/components/dashboard/manage-columns-dropdown.tsx` around line 81

- [ ] Configure Tooltip Delay (AC: 3)
  - [ ] Verify TooltipProvider has delayDuration set to 500ms (already defaults to 0 in component, update if needed)
  - [ ] Ensure all tooltips use the standard delay
  - [ ] Check `src/components/ui/tooltip.tsx` configuration

- [ ] Add Translations for Tooltips (AC: 1, 2)
  - [ ] Add tooltip text keys to `messages/en.json` for English
  - [ ] Add tooltip text keys to `messages/sv.json` for Swedish
  - [ ] Use `useTranslations` hook to access tooltip text in components
  - [ ] Ensure all tooltip text is translatable (no hardcoded English strings)

- [ ] Accessibility Testing (AC: 4, 5)
  - [ ] Test keyboard navigation: Tab to button, tooltip should appear
  - [ ] Test screen reader compatibility: aria-labels should work with tooltips
  - [ ] Test on Chrome, Firefox, Safari, Edge
  - [ ] Verify WCAG 2.1 AA compliance for tooltip contrast and readability
  - [ ] Test tooltips in both Swedish and English languages

## Dev Notes

### Component Architecture

- **Tooltip Component**: Located at `src/components/ui/tooltip.tsx`
- Built with Radix UI `@radix-ui/react-tooltip` primitive
- Already configured with proper accessibility (keyboard support, ARIA attributes)
- Components: `Tooltip`, `TooltipTrigger`, `TooltipContent`, `TooltipProvider`

### Current Tooltip Implementation

The tooltip component is already set up and used in the column settings table. Key points:

- `delayDuration` defaults to 0ms in TooltipProvider (line 9 of tooltip.tsx) - may need to be set to 500ms per AC #3
- Tooltip has auto-positioning with `sideOffset` parameter
- Includes arrow pointer for better UX
- Styled with foreground/background color inversion for visibility

### Locations of Action Buttons Requiring Tooltips

**1. Employee Table (`src/components/dashboard/employee-table.tsx`)**

- Archive button (line ~424): Already has `title` attribute, replace with Tooltip
- Unarchive button (line ~419): Already has `title` attribute, replace with Tooltip
- Terminate button (line ~445): Already has `title` attribute, replace with Tooltip
- Reactivate button (line ~436): Already has `title` attribute, replace with Tooltip

**2. Dashboard Header (`src/app/[locale]/dashboard/page.tsx`)**

- Add Employee button (line ~96): Currently has `title` for preview mode only
- Import CSV button (line ~104): Currently has `title` for preview mode only
- Add Custom Column button (line ~115): No tooltip currently
- Manage Columns Dialog trigger: In `src/components/dashboard/manage-columns-dropdown.tsx`

**3. Important Dates Table (`src/components/dashboard/important-dates-table.tsx`)**

- Delete button (line ~228): Has `aria-label` but no tooltip

**4. Column Settings Table (`src/components/admin/column-settings-table.tsx`)**

- Already uses Tooltip component (lines 15-20 import)
- Delete and visibility toggle buttons should have tooltips

**5. Admin Columns Page Filter Buttons (`src/app/[locale]/dashboard/admin/columns/page.tsx`)**

- Filter buttons (All/Masterdata/Custom) around lines 71-91 - these are informational, tooltips optional

### Usage Pattern

Based on existing Column Settings Table implementation:

```tsx
import {
  Tooltip,
  TooltipContent,
  TooltipTrigger,
} from '@/components/ui/tooltip';
import { useTranslations } from 'next-intl';

// Inside component:
const t = useTranslations('tooltips'); // Access tooltip translations

<Tooltip>
  <TooltipTrigger asChild>
    <Button variant="ghost" size="sm">
      <Icon className="h-4 w-4" />
    </Button>
  </TooltipTrigger>
  <TooltipContent>
    <p>{t('archiveEmployee')}</p>
  </TooltipContent>
</Tooltip>;
```

### Multi-Language Support (CRITICAL)

**Story 5.9 added Swedish/English language toggle** - all tooltip text MUST be translatable:

- Add tooltip translation keys to `messages/en.json` and `messages/sv.json`
- Use `useTranslations('tooltips')` hook to access translated strings
- NEVER hardcode English text in tooltip content
- Suggested translation namespace: `tooltips` (e.g., `t('tooltips.archiveEmployee')`)

**Example Translation Structure:**

```json
// messages/en.json
{
  "tooltips": {
    "archiveEmployee": "Archive employee",
    "restoreEmployee": "Restore employee",
    "terminateEmployee": "Mark as terminated",
    "reactivateEmployee": "Reactivate employee",
    "addEmployee": "Add new employee to the system",
    "importCsv": "Import employees from CSV file",
    "addColumn": "Create a new custom column",
    "deleteDate": "Delete this important date",
    "editColumn": "Edit column name and category",
    "deleteColumn": "Delete custom column",
    "hideColumn": "Hide column from table",
    "showColumn": "Show column in table"
  }
}

// messages/sv.json
{
  "tooltips": {
    "archiveEmployee": "Arkivera anställd",
    "restoreEmployee": "Återställ anställd",
    "terminateEmployee": "Markera som uppsagd",
    "reactivateEmployee": "Återaktivera anställd",
    "addEmployee": "Lägg till ny anställd i systemet",
    "importCsv": "Importera anställda från CSV-fil",
    "addColumn": "Skapa en ny anpassad kolumn",
    "deleteDate": "Ta bort detta viktiga datum",
    "editColumn": "Redigera kolumnnamn och kategori",
    "deleteColumn": "Ta bort anpassad kolumn",
    "hideColumn": "Dölj kolumn från tabell",
    "showColumn": "Visa kolumn i tabell"
  }
}
```

### Important Notes

- **Replace `title` attributes**: Several buttons use native HTML `title` which has inconsistent browser behavior. Replace with Tooltip component for consistency.
- **Preserve existing functionality**: When wrapping buttons, ensure disabled states and onClick handlers remain functional
- **Preview mode handling**: Dashboard buttons have conditional `title` for preview mode - ensure this logic works with Tooltip
- **AsChild pattern**: Use `asChild` prop on TooltipTrigger to merge with Button component props

### Testing

**Test File Location**: `tests/unit/components/` (per testing-strategy.md)

**Test Standards** (from testing-strategy.md):

- Use Vitest as testing framework
- Use React Testing Library for component tests
- Test accessibility with `@testing-library/jest-dom` matchers
- Coverage goal: 60%+ for UI components

**Key Test Cases**:

1. Tooltip appears on hover after delay
2. Tooltip appears on keyboard focus
3. Tooltip text is correct for each button
4. Tooltip doesn't interfere with button click functionality
5. Tooltip is accessible (screen reader compatible)
6. Tooltip works when button is disabled (or doesn't show - verify expected behavior)

**Testing Approach**:

```typescript
// Example test structure
import { render, screen, waitFor } from '@testing-library/react';
import userEvent from '@testing-library/user-event';

test('shows tooltip on hover', async () => {
  const user = userEvent.setup();
  render(<ComponentWithTooltip />);

  const button = screen.getByRole('button', { name: /archive/i });
  await user.hover(button);

  await waitFor(() => {
    expect(screen.getByText(/archive employee/i)).toBeInTheDocument();
  });
});
```

### Coding Standards References

- **Component naming**: PascalCase for React components
- **Import organization**: UI components from `@/components/ui/`
- **Type safety**: Ensure all props are properly typed
- **Accessibility**: Must meet WCAG AA standards (per architecture docs)

### Related Previous Stories

- **Story 5.9 (Language Toggle)**: CRITICAL DEPENDENCY - All tooltip text must be added to translation files (`messages/en.json` and `messages/sv.json`) to support Swedish/English language toggle
- Story 5.8 (Sign-out in Header): Header component may need tooltips for user menu items

## Change Log

| Date       | Version | Description            | Author             |
| ---------- | ------- | ---------------------- | ------------------ |
| 2025-10-30 | 1.0     | Initial story creation | Scrum Master (Bob) |

## Dev Agent Record

### Agent Model Used

_To be populated by dev agent_

### Debug Log References

_To be populated by dev agent_

### Completion Notes List

_To be populated by dev agent_

### File List

_To be populated by dev agent_

## QA Results

_To be populated by QA agent_
