# Manual Testing Scenarios for Story 4.6: Change Notifications

## Overview
This document contains manual testing scenarios to verify the change notification system for external party users.

## Prerequisites
- Two browser sessions (or incognito windows) for testing
- Test database with sample employees
- HR Admin user account
- External party user accounts (Sodexo, ÖMC, Payroll, Toplux)

---

## Scenario 1: Employee Enters View (Filter Change)

**Objective:** Verify notification when an employee newly matches filter criteria

**Steps:**
1. Login as Sodexo user in Browser 1
2. Apply filter: `includeArchived = false`, `includeTerminated = false`
3. Note the current list of visible employees
4. In Browser 2, login as HR Admin
5. Update an employee's `hire_date` from `2024-12-01` to `2025-01-15`
6. Switch back to Browser 1 (Sodexo user)

**Expected Results:**
- ✅ Toast notification appears: "1 new employee matches your filters: [Employee Name]"
- ✅ Notification positioned at bottom-right corner
- ✅ Employee row appears in table with blue highlight
- ✅ Notification auto-dismisses after 5 seconds
- ✅ X button allows manual dismissal
- ✅ Click on notification scrolls to and highlights the employee row

---

## Scenario 2: Employee Leaves View (Archived/Terminated)

**Objective:** Verify notification when an employee no longer matches filter criteria

**Steps:**
1. Login as ÖMC user in Browser 1
2. Note a visible employee in the table
3. In Browser 2 (HR Admin), archive that employee
4. Switch back to Browser 1 (ÖMC user)

**Expected Results:**
- ✅ Toast notification appears: "1 employee no longer matches your filters: [Employee Name]"
- ✅ Employee row disappears from ÖMC table
- ✅ Notification auto-dismisses after 5 seconds
- ✅ No error in console

---

## Scenario 3: Employee Updated in View (Email Change)

**Objective:** Verify notification when an employee's masterdata is updated

**Steps:**
1. Login as Payroll user in Browser 1 (viewing unfiltered table)
2. Note a visible employee
3. In Browser 2 (HR Admin), update that employee's email address
4. Switch back to Browser 1 (Payroll user)

**Expected Results:**
- ✅ Toast notification appears: "Employee [Name] was updated (Email changed)"
- ✅ Employee row shows updated email
- ✅ Row has blue highlight animation (2-second duration)
- ✅ Notification auto-dismisses after 5 seconds

---

## Scenario 4: Batched Notifications (CSV Import)

**Objective:** Verify batched notifications for multiple simultaneous changes

**Steps:**
1. Login as Toplux user in Browser 1
2. Apply filter: `hire_date >= 2025-01-01`
3. Note the number of visible employees
4. In Browser 2 (HR Admin), import a CSV with 10 employees
   - 5 employees have `hire_date >= 2025-01-01`
   - 5 employees have `hire_date < 2025-01-01`
5. Switch back to Browser 1 (Toplux user)

**Expected Results:**
- ✅ Toast notification appears: "5 new employees match your filters"
- ✅ All 5 matching employees appear in Toplux table
- ✅ No individual notifications for each employee (batching works)
- ✅ Notification auto-dismisses after 5 seconds
- ✅ Performance: Notification appears within 2 seconds of import

---

## Scenario 5: Accessibility with Screen Reader

**Objective:** Verify notifications are accessible to screen reader users

**Steps:**
1. Enable screen reader (NVDA/JAWS on Windows, or VoiceOver on Mac)
2. Login as Sodexo user
3. In separate browser, login as HR Admin and update an employee
4. Listen to screen reader announcements

**Expected Results:**
- ✅ Screen reader announces notification message
- ✅ ARIA live region is properly configured
- ✅ Notification is keyboard-accessible
- ✅ Tab key focuses dismiss button
- ✅ Enter key dismisses notification
- ✅ Esc key closes notification

---

## Scenario 6: No Notification for Own Edits (Custom Columns)

**Objective:** Verify notifications don't trigger for custom column edits

**Steps:**
1. Login as Sodexo user in Browser 1
2. Edit a custom Sodexo column for an employee
3. Observe for notifications

**Expected Results:**
- ✅ NO notification appears for own custom column edit
- ✅ Table updates correctly
- ✅ No errors in console

---

## Scenario 7: Performance Test

**Objective:** Verify notification logic executes quickly

**Steps:**
1. Login as external party user
2. Open browser DevTools Console
3. In separate browser, HR Admin updates employee data
4. Check console for performance warnings

**Expected Results:**
- ✅ No warning: "Notification logic exceeded 100ms"
- ✅ No warning: "Real-time event processing exceeded 100ms"
- ✅ Notification appears smoothly without UI lag

---

## Scenario 8: Connection Status Indicator

**Objective:** Verify real-time connection status is visible

**Steps:**
1. Login as external party user
2. Observe connection status indicator in employee table

**Expected Results:**
- ✅ Green indicator shows "Connected" status
- ✅ If connection drops, indicator shows "Reconnecting"
- ✅ When reconnected, indicator returns to "Connected"

---

## Scenario 9: Multiple Notifications Management

**Objective:** Verify handling of multiple notifications

**Steps:**
1. Login as external party user
2. Trigger 3 separate employee updates rapidly
3. Observe notification behavior

**Expected Results:**
- ✅ Notifications batch if within 200ms window
- ✅ If >200ms apart, separate notifications appear
- ✅ All notifications are dismissible
- ✅ Stacking behavior is clear and not overwhelming

---

## Test Completion Checklist

- [ ] Scenario 1: Employee Enters View - Passed
- [ ] Scenario 2: Employee Leaves View - Passed
- [ ] Scenario 3: Employee Updated in View - Passed
- [ ] Scenario 4: Batched Notifications - Passed
- [ ] Scenario 5: Accessibility - Passed
- [ ] Scenario 6: No Notification for Own Edits - Passed
- [ ] Scenario 7: Performance Test - Passed
- [ ] Scenario 8: Connection Status - Passed
- [ ] Scenario 9: Multiple Notifications - Passed

---

## Notes

_Add any observations, issues, or additional notes here during testing._
